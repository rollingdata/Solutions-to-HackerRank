SELECT B.N, CASE WHEN B.P IS NULL THEN 'Root'
                 WHEN NOT EXISTS(SELECT * FROM BST temp WHERE temp.P=B.N) THEN 'Leaf' ELSE 'Inner' END
FROM BST B
ORDER BY N
